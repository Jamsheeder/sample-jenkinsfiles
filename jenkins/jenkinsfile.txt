pipeline {
	agent any

	stages {
	   stage('Preparation') { // for display purposes
	   
	      steps {
		      // Get some code from a GitHub repository
		      git 'https://github.com/Jamsheeder/sample-jenkinsfiles.git'
		  }
	   }
	   stage('Build') {
	   
	      when {
	      	  expression{ isUnix() == 'true' }
	      }
	      steps {
		         sh "./gradlew clean build"
		  }
		  
	      when {
	      	  expression{ isUnix() == 'false' }
	      }
	      steps {
		         bat "./gradlew clean build"
		  }
		  
	   }
	}
	post {
	  always {
	      echo 'post -> always'
	      step([$class: 'Publisher', reportFilenamePattern: '**/testng-results.xml'])
	  }
	  failure {
	      echo 'post -> failure'
	  }
    }
}